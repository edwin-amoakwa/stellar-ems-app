<div class="term-class-component">
  <div class="toolbar">
    <button pButton type="button" label="Refresh" icon="pi pi-refresh" class="p-button-text" (click)="refresh()"></button>
  </div>

  <!-- Loading State -->
  <div class="loading" *ngIf="isLoading">
    <p-progressSpinner styleClass="w-3rem h-3rem"></p-progressSpinner>
    <span class="ml-2">Loading classes...</span>
  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && error" class="error">
    <i class="pi pi-exclamation-triangle mr-2"></i>
    {{ error }}
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && !error && (!items || items.length === 0)" class="empty">
    <i class="pi pi-info-circle mr-2"></i>
    No classes available.
  </div>

  <!-- Table Mode -->
  <div *ngIf="!isLoading && !error && items?.length && displayMode === 'table'">
    <p-table [value]="items" [loading]="isLoading" styleClass="p-datatable-sm clickable-table" [paginator]="false">
      <ng-template pTemplate="header" *ngIf="showHeader">
        <tr>
          <th>Class Name</th>
<!--          <th>Academic Term Code</th>-->
<!--          <th>Class Teacher</th>-->

        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr (click)="onRowClick(item)" class="clickable-row">
          <td>{{ item.schoolClassName }}</td>
<!--          <td>{{ item.academicTermCode }}</td>-->
<!--          <td>{{ item.classTeacherName }}</td>-->
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Dropdown Mode -->
  <div *ngIf="!isLoading && !error && items?.length && displayMode === 'dropdown'" class="dropdown-wrapper">
    <p-dropdown
      [options]="items"
      optionLabel="schoolClassName"
      optionValue="schoolClassId"
      [placeholder]="placeholder"
      [(ngModel)]="selectedId"
      (onChange)="onDropdownChange($event.value)"
      [showClear]="true"
      class="w-full"
    >
      <ng-template pTemplate="selectedItem" let-item>
        <div *ngIf="item">{{ item.schoolClassName }}</div>
        <div *ngIf="!item" class="placeholder">{{ placeholder }}</div>
      </ng-template>
      <ng-template let-item pTemplate="item">
        <div class="option-item">
          <div class="name">{{ item.schoolClassName }}</div>
          <div class="meta">{{ item.academicTermCode }} â€¢ {{ item.classTeacherName }}</div>
        </div>
      </ng-template>
    </p-dropdown>
  </div>
</div>
