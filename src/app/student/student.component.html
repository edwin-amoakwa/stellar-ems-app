<h1 class="page-title">Students</h1>


<div *ngIf="formView.listView" >
    <button-toolbar>
        <p-button
                label="New Student"
                icon="pi pi-plus"
                (onClick)="initNewStudent()"
                styleClass="p-button-primary">
        </p-button>

    </button-toolbar>

    <app-card>

        <p-table #dataTable
                 [value]="studentList" dataKey="id"
                 [loading]="loading"
                 [paginator]="true"
                 [rows]="10"
                 [showCurrentPageReport]="true"
                 currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                 [rowsPerPageOptions]="[10, 25, 50]"
                 [globalFilterFields]="['referenceNo', 'firstName', 'surname', 'mobileNo']"
                 styleClass="p-datatable-gridlines">

            <ng-template #caption>
                <div class="clearfix">
                    <div class="flex justify-content-end float-end">
                        <p-iconfield iconPosition="left" >
                            <p-inputicon>
                                <i class="pi pi-search"></i>
                            </p-inputicon>
                            <input pInputText type="text" (input)="dataTable.filterGlobal($any($event.target).value, 'contains')" placeholder="Search keyword" />
                        </p-iconfield>
                    </div>
                </div>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <!--        <th>SystemId</th>-->
                    <th>Student No</th>
                    <th>First Name</th>
                    <th>Surname</th>
                    <th>Date of Birth</th>
                    <th>Actions</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-user>
                <tr>
                    <td>{{ user.referenceNo }}</td>
                    <td>{{ user.firstName }}</td>
                    <td>{{ user.surname }}</td>
                    <td>{{ user.dateOfBirth | date}}</td>

                    <td>
                        <p-button
                                icon="pi pi-pencil"
                                (onClick)="editStudent(user)"
                                styleClass="p-button-rounded p-button-text p-button-info mr-1"
                                pTooltip="Edit">
                        </p-button>


                        <p-button icon="pi pi-trash"
                                  (onClick)="deleteStudent(user)"
                                  styleClass="p-button-rounded p-button-text p-button-danger"
                                  pTooltip="Delete">
                        </p-button>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="11" class="text-center">No staff found</td>
                </tr>
            </ng-template>
        </p-table>

    </app-card>


</div>

<div *ngIf="formView.createView" >
    <app-card [title]="selectedStudent ? 'Edit Student' : 'Create Student'">


        <form [formGroup]="studentForm" (ngSubmit)="onSubmit()">
            <!-- Row 1: Username + Reference No -->
            <div class="row">
                <!--      <div class="col-12 col-md-6 mb-3">-->
                <!--        <div class="row">-->
                <!--          <div class="col-12 col-sm-4">-->
                <!--            <label for="username">Username *</label>-->
                <!--          </div>-->
                <!--          <div class="col-12 col-sm-8">-->
                <!--            <input pInputText id="username" formControlName="username" InputRequired class="w-full" />-->
                <!--          </div>-->
                <!--        </div>-->
                <!--      </div>-->
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="referenceNo">Student No</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="referenceNo" formControlName="referenceNo" class="w-full" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 2: First Name + Surname -->
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="firstName">First Name *</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="firstName" formControlName="firstName" appValidateInput class="w-full" />
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="surname">Surname *</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="surname" formControlName="surname" appValidateInput class="w-full" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 3: Other Names + Date of Birth -->
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="othernames">Other Names</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="othernames" formControlName="othernames"  class="w-full" />
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="dateOfBirth">Date of Birth</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input id="dateOfBirth" type="date" formControlName="dateOfBirth" class="w-full" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 4: Gender + Email Address -->
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="gender">Sex</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <p-select id="region"
                                      [options]="sexList"
                                      optionLabel="itemName"
                                      optionValue="id"
                                      formControlName="gender" appValidateInput
                                      styleClass="w-full"></p-select>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="emailAddress">Email Address</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="emailAddress" formControlName="emailAddress" class="w-full" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 5: Mobile No + Other Contact Nos -->
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="mobileNo">Mobile No *</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="mobileNo" formControlName="mobileNo" appValidateInput class="w-full" />
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="otherContactNos">Other Contact Nos</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="otherContactNos" formControlName="otherContactNos" class="w-full" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 6: Region + Religion -->
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="region">Region</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <p-select id="region"
                                      [options]="regionsList"
                                      optionLabel="itemName"
                                      optionValue="id"
                                      formControlName="region"
                                      styleClass="w-full"></p-select>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="religion">Religion</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <p-select id="religion"
                                      [options]="religionOptions"
                                      optionLabel="itemName"
                                      optionValue="id"
                                      formControlName="religion"
                                      styleClass="w-full"></p-select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 7: Home Town + (Spacer) -->
            <div class="row">
                <div class="col-12 col-md-6 mb-3">
                    <div class="row">
                        <div class="col-12 col-sm-4">
                            <label for="homeTown">Home Town</label>
                        </div>
                        <div class="col-12 col-sm-8">
                            <input pInputText id="homeTown" formControlName="homeTown" class="w-full" />
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-3"></div>
            </div>

            <!-- Full-width: Postal Address -->
            <div class="row">
                <div class="col-12 mb-3">
                    <div class="row">
                        <div class="col-12 col-md-2 col-lg-2 col-xl-2">
                            <label for="postalAddress">Postal Address</label>
                        </div>
                        <div class="col-12 col-md-10 col-lg-10 col-xl-10">
                            <textarea id="postalAddress"  pTextarea formControlName="postalAddress" class="w-full" rows="2"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Full-width: Residential Address -->
            <div class="row">
                <div class="col-12 mb-3">
                    <div class="row">
                        <div class="col-12 col-md-2 col-lg-2 col-xl-2">
                            <label for="residentialAddress">Residential Address</label>
                        </div>
                        <div class="col-12 col-md-10 col-lg-10 col-xl-10">
                            <textarea id="residentialAddress" pTextarea formControlName="residentialAddress" class="w-full" rows="2"></textarea>
                        </div>
                    </div>
                </div>
            </div>



            <button-toolbar>
                <close-button
                        type="button"
                        label="Cancel" (click)="formView.resetToListView()">
                </close-button>
                <p-button
                        type="submit"
                        [label]="selectedStudent ? 'Update Student' : 'Create Student'"
                        icon="pi pi-check"
                        (onClick)="onSubmit()"
                        [loading]="loading"
                        styleClass="p-button-primary">
                </p-button>
            </button-toolbar>

        </form>


    </app-card>
</div>

